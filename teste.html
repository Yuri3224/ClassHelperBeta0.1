<!DOCTYPE html>
<html>
<head>
	<title>ChatGPT API Example</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

	<input type="text" id="inputQuestion" placeholder="Faça uma pergunta">
	<button id="submitQuestion">Enviar</button>
	<button id="clearChat">Limpar Chat</button>

	<div id="messages"></div>

	<script>

		const OPENAI_API_KEY = "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";

		const inputQuestion = document.getElementById("inputQuestion");
		const messages = document.getElementById("messages");
		const submitQuestion = document.getElementById("submitQuestion");
		const clearChat = document.getElementById("clearChat");

		submitQuestion.addEventListener("click", (e) => {
			e.preventDefault();
			const sQuestion = inputQuestion.value;
			if (sQuestion) {
				addMessage("Você", sQuestion);
				inputQuestion.value = "";
				getAnswerFromAPI(sQuestion);
			}
		});

		clearChat.addEventListener("click", () => {
			messages.innerHTML = "";
		});

		async function getAnswerFromAPI(sQuestion) {
			const requestOptions = {
				method: "POST",
				headers: {
					"Content-Type": "application/json",
					Authorization: `Bearer ${OPENAI_API_KEY}`,
				},
				body: JSON.stringify({
					model: "text-davinci-002",
					prompt: sQuestion,
					temperature: 0.7,
					max_tokens: 60,
					n: 1,
					stop: "\n"
				}),
			};

			try {
				const response = await fetch("https://api.openai.com/v1/completions", requestOptions);
				const data = await response.json();
				const answer = data.choices[0].text.trim();
				addMessage("ChatGPT", answer);
			} catch (error) {
				console.error(error);
			}
		}

		function addMessage(sender, message) {
			const messageBox = document.createElement("div");
			messageBox.innerHTML = `<strong>${sender}: </strong>${message}`;
			messages.appendChild(messageBox);
		}

	</script>

</body>
</html>
